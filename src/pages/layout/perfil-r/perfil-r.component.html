<app-loading *ngIf="data.loading"></app-loading>
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Editar representante</h4>
      </div>
      <div class="modal-body">
        <div class="box box-warning">
          <div class="box-header with-border">
            <h3 class="box-title">Representante</h3>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <form role="form" ngNativeValidate (ngSubmit)="saveRepresentante()">
              <div class="form-group">
                <label>Email</label>
                <input type="text" class="form-control" name="email" placeholder="email" [(ngModel)]="representante.email"
                  required>
              </div>
              <div class="form-group">
                <label>Nombre</label>
                <input type="text" class="form-control" name="nombre" placeholder="nombre" [(ngModel)]="representante.nombre"
                  required>
              </div>
              <div class="form-group">
                <label>Apellido</label>
                <input type="text" class="form-control" name="apellido" placeholder="apellido" [(ngModel)]="representante.apellido"
                  required>
              </div>
              <div class="form-group">
                <label>Numero de contacto 1</label>
                <input type="text" class="form-control" name="numero_contacto_1" placeholder="numero de contacto" [(ngModel)]="representante.numero_contacto_1"
                  required>
              </div>
              <div class="form-group">
                <label>Numero de contacto 2</label>
                <input type="text" class="form-control" name="numero_contacto_2" placeholder="numero de contacto" [(ngModel)]="representante.numero_contacto_2"
                  required>
              </div>
              <div class="form-group">
                <label>Estado</label>
                <select class="form-control" [(ngModel)]="data.user_a.representante.municipio.estado_id" name="select_estado" (ngModelChange)="changeEstate()"
                  required>
                  <option [ngValue]="estado.id" *ngFor="let estado of data.estados">{{estado.descripcion}}</option>
                </select>
              </div>
              <div class="form-group">
                <label>Municipio</label>
                <select class="form-control" [(ngModel)]="data.user_a.representante.municipio_id" name="select_municipio" required>
                  <option [ngValue]="municipio.id" *ngFor="let municipio of data.estado_a.municipios">{{municipio.descripcion}}</option>
                </select>
              </div>
              <div class="modal-footer">
                <button class="btn btn-default" data-dismiss="modal">Cancelar</button>
                <button type="submit" class="btn btn-info pull-right">Guardar</button>
              </div>
            </form>
          </div>
          <!-- /.box-body -->
        </div>
      </div>

    </div>
  </div>
</div>

<div class="perfil-r-page" [@routerTransition]>
  <!-- Content Header (Page header) -->
  <section class="content-header">
    <h1>
      Perfil del Representante
    </h1>
    <ol class="breadcrumb">
      <li *ngFor="let route of data.bread_crumb">
        <a [routerLink]="[route.route]">
          <i class="fa fa-dashboard"></i> {{route.name}}</a>
      </li>
    </ol>
  </section>

  <!-- Main content -->
  <section class="content">

    <div class="row">
      <div class="col-md-3">

        <!-- Profile Image -->
        <div class="box box-primary">
          <div class="box-body box-profile">
            <img class="profile-user-img img-responsive img-circle" src="../../../assets/images/user_profile.png" alt="Imagen de usuario">

            <h3 class="profile-username text-center">{{data.user_a.username}}</h3>

            <p class="text-muted text-center">{{data.user_a.email}}</p>

            <ul class="list-group list-group-unbordered">
              <li class="list-group-item">
                <b>Nombre</b>
                <p class="pull-right">{{data.user_a.representante.nombre}}</p>
              </li>
              <li class="list-group-item">
                <b>Apellido</b>
                <p class="pull-right">{{data.user_a.representante.apellido}}</p>
              </li>
              <li class="list-group-item">
                <b>Cedula</b>
                <p class="pull-right">{{data.user_a.representante.cedula}}</p>
              </li>
            </ul>

            <a href="#" class="btn btn-primary btn-block" data-toggle="modal" data-target="#myModal" (click)="copyData()">
              <b>Editar</b>
            </a>
          </div>
          <!-- /.box-body -->
        </div>
        <!-- /.box -->

        <!-- About Me Box -->
        <div class="box box-primary">
          <div class="box-header with-border">
            <h3 class="box-title">Acerca de mi</h3>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <strong>
              <i class="fa fa-book margin-r-5"></i> Numero de telefono 1</strong>

            <p class="text-muted">
              {{data.user_a.representante.numero_contacto_1}}
            </p>

            <hr>

            <strong>
              <i class="fa fa-map-marker margin-r-5"></i> Numero de telefono 2</strong>

            <p class="text-muted">{{data.user_a.representante.numero_contacto_2}}</p>

            <hr>

            <strong>
              <i class="fa fa-file-text-o margin-r-5"></i> Dirección</strong>
            <h3>Municipio</h3>
            <p>{{data.user_a.representante.municipio.descripcion}}</p>
            <h3>Estado</h3>
            <p>{{data.user_a.representante.municipio.estado.descripcion}}</p>
          </div>

          <a href="#" class="btn btn-primary btn-block" data-toggle="modal" data-target="#myModal" (click)="copyData()">
            <b>Editar</b>
          </a>
          <!-- /.box-body -->
        </div>
        <!-- /.box -->
      </div>
      <div class="col-md-7">
        <div class="row">
          <div class="col-md-12">
            <div class="box box-success box-solid collapsed-box">
              <div class="box-header with-border">
                <h3 class="box-title">Agregar nuevo niño</h3>
                <div class="box-tools pull-right">
                  <button type="button" class="btn btn-box-tool" data-widget="collapse" (click)="slide('new_child')">
                    <i id="inew_child" class="fa fa-plus"></i>
                  </button>
                </div>
              </div>
              <div class="box-body new_child">
                <form role="form" ngNativeValidate (ngSubmit)="newChild()">
                  <div class="form-group">
                    <label>Nombre</label>
                    <input type="text" class="form-control" placeholder="nombre" [(ngModel)]="data.ninho_a.nombre" name="name" required>
                  </div>
                  <div class="form-group">
                    <label>Apellido</label>
                    <input type="text" class="form-control" placeholder="apellido" [(ngModel)]="data.ninho_a.apellido" name="apellido" required>
                  </div>
                  <div class="form-group">
                    <label>Descripción de la situación</label>
                    <textarea class="form-control" rows="3" style="max-width: 100%;" placeholder="Descripción ..." [(ngModel)]="data.ninho_a.descripcion_situacion"
                      name="descripcion_situacion" required></textarea>
                  </div>
                  <button type="submit" class="btn btn-info pull-right btn-block">Guardar</button>
                </form>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6" *ngFor="let ninho of representante.ninhos">
            <!-- Widget: user widget style 1 -->
            <div class="box box-widget widget-user-2">
              <!-- Add the bg color to the header using any of the bg-* classes -->
              <div class="widget-user-header bg-yellow box-body">
                <div class="box-tools pull-right box-tools pull-right">
                  <button type="button" class="btn btn-box-tool">
                    <i class="fa fa-trash" aria-hidden="true"></i>
                  </button>
                </div>
                <div class="widget-user-image">
                  <img class="img-circle" src="../../../../assets/images/niño.jpg" alt="Foto del niño">
                </div>
                <!-- /.widget-user-image -->
                <h3 class="widget-user-username">{{ninho.nombre}}</h3>
                <h5 class="widget-user-desc">{{ninho.descripcion_situacion}}</h5>
              </div>
              <div class="box-footer no-padding n1">
                <ul class="nav nav-stacked">
                  <li *ngFor="let cancer of ninho.cancer">
                    <a>
                      <div class="row">
                        <div class="col-md-7">{{cancer.descripcion}}</div>
                        <div class="col-md-5">
                          <span class="pull-right badge bg-blue">{{cancer.cancer.nombre}}</span>
                        </div>
                      </div>
                    </a>
                  </li>
                </ul>
                <a [routerLink]="['/ninho']" class="btn btn-primary btn-block" (click)="goChild(ninho.id)">
                  <b>ver</b>
                </a>
              </div>
            </div>
          </div>
        </div>
        <!-- /.widget-user -->
      </div>
    </div>
    <!-- /.row -->

  </section>
  <!-- /.content -->
</div>